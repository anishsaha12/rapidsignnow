{% extends 'law_firm/base.html' %}

{% load staticfiles %}

{% block theme_styles %}
<link href="{% static 'theme/bs3/css/bootstrap.min.css' %}" rel="stylesheet">
<link href="{% static 'theme/css/bootstrap-reset.css' %}" rel="stylesheet">
<link href="{% static 'theme/font-awesome/css/font-awesome.css' %}" rel="stylesheet" />

<!-- Custom styles for this template -->
<link href="{% static 'theme/css/style.css' %}" rel="stylesheet">
<link href="{% static 'theme/css/style-responsive.css' %}" rel="stylesheet" />
{% endblock theme_styles %}

{% block other_styles %}
{% endblock other_styles %}

{% load range_filter %}

{% block content %}

<div class="col-lg-12">
    <section class="panel">
        <header class="panel-heading">
            Change Password
        </header>
        <div class="panel-body">
            <div class="position-center">
                <form class="form-horizontal" role="form">
                    <div class="form-group">
                        <label for="oldPassword" class="col-lg-3 col-sm-3 control-label">Old Password</label>
                        <div class="col-lg-9">
                            <input type="password" class="form-control" id="oldPassword" name="old_password" placeholder="Old Password">
                            {% if error %}<p class="help-block">{{ error }}</p>{% endif %}
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="newPassword" class="col-lg-3 col-sm-3 control-label">New Password</label>
                        <div class="col-lg-9">
                            <input type="password" class="form-control" id="newPassword" name="new_password" placeholder="New Password">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="newPasswordConfirm" class="col-lg-3 col-sm-3 control-label">New Password (Again)</label>
                        <div class="col-lg-9">
                            <input type="password" class="form-control" id="newPasswordConfirm" name="new_password_confirm" placeholder="New Password (Again)">
                        </div>
                    </div>

                    {% csrf_token %}

                    <div class="form-group">
                        <div class="col-lg-offset-3 col-lg-10">
                            <button type="submit" id="changePasswordBtn" class="btn btn-danger">Change Password</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>

</div>
{% endblock content %}


{% block theme_scripts %}
<script src="{% static 'theme/js/jquery.js' %}"></script>
<script src="{% static 'theme/bs3/js/bootstrap.min.js' %}"></script>
<script src="{% static 'theme/js/jquery.dcjqaccordion.2.7.js' %}" class="include"></script>
<script src="{% static 'theme/js/jquery.scrollTo.min.js' %}"></script>
<script src="{% static 'theme/js/jQuery-slimScroll-1.3.0/jquery.slimscroll.js' %}"></script>
<script src="{% static 'theme/js/jquery.nicescroll.js' %}"></script>
<script src="{% static 'theme/js/iCheck/jquery.icheck.js' %}"></script>
<script src="{% static 'theme/js/jquery.validate.min.js' %}"></script>


<!--common script init for all pages-->
<script src="{% static 'theme/js/scripts.js' %}"></script>

{% endblock theme_scripts %}

{% block other_scripts %}

<script>
    
     jQuery(document).ready(function () {
        $('a[data-nav-item=change-password]').addClass('active');
        $('#navigation-button').hide();
        $('#changePasswordBtn').click(function () {
            'use strict';


            if ($('#newPassword').val() !== $('#newPasswordConfirm').val()) {
                swal({
                    title: 'Error',
                    text: 'New Passwords do not match!',
                    type: 'error',
                    timer: 2000,
                    showConfirmButton: false
                });
            } else {

                swal({
                    title: 'Change Password',
                    text: 'Are you sure?',
                    type: 'question',
                    confirmButtonText: 'Yes',
                    showCancelButton: true,
                    cancelButtonText: 'No'
                }).then(function () {

                    $.post(location.pathname, {
                        csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
                        context: 'changePassword',
                        old_password: $('#oldPassword').val(),
                        new_password: $('#newPassword').val(),
                        new_password_confirm: $('#newPasswordConfirm').val(),
                    }, function (data) {
                        // debugger;
                        if(data.success == "true"){
                            swal({
                                title: 'Success!',
                                text: 'Your password has been changed',
                                type: 'success',
                                timer: 2000,
                                showConfirmButton: false
                            });

                            setTimeout(function(){
                                location.reload();
                            },2000);
                        }else{
                         swal({
                                title: 'Error',
                                text: 'Old Password does not match!',
                                type: 'error',
                                timer: 2000,
                                showConfirmButton: false
                            });   
                        }
                        
                    });

            });

            }
        return false;

        });
    });
</script>
{% endblock other_scripts %}